#!/usr/bin/env bash
set -euo pipefail

# commit-msg: Enforce Conventional Commits
# Pattern: type(scope): description

RED='\033[0;31m'
NC='\033[0m'
commit_msg_file=$1
commit_msg=$(cat "$commit_msg_file")

# Regex for Conventional Commits
# Types: feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert
pattern="^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\([a-z0-9\._-]+\))?: .+$"

if ! [[ "$commit_msg" =~ $pattern ]]; then
    echo -e "${RED}‚ùå ERROR: Invalid commit message format.${NC}"
    echo "Expected: type(scope): description"
    echo "Example:  feat(auth): add login endpoint"
    echo "Types:    feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert"
    exit 1
fi
